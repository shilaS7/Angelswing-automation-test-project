# Instructions

- Following Playwright test failed.
- Explain why, be concise, respect Playwright best practices.
- Provide a snippet of code with the fix, if possible.

# Test info

- Name: Measurement Page Test >> Location E2E Test >> Should create group, Location and validate x, y coordinates and elevation on map and side bar @poc
- Location: D:\Angelswing_QA\angelswing-automation-test\tests\frontend-tests\measurement.spec.ts:349:13

# Error details

```
Error: Elevation on side bar is not equal to expected Elevation

expect(received).toBe(expected) // Object.is equality

Expected: "No DSM data m"
Received: "No DSM"
    at assertLocationValuesOnMapAndSideBarWithExpectedValues (D:\Angelswing_QA\angelswing-automation-test\tests\frontend-tests\measurement.spec.ts:118:96)
    at D:\Angelswing_QA\angelswing-automation-test\tests\frontend-tests\measurement.spec.ts:369:19
```

# Test source

```ts
   18 |
   19 |     const projectTitle: string = process.env.PROJECT_TITLE || '';
   20 |
   21 |     test.beforeAll(async ({ browser }, testInfo) => {
   22 |         context = await browser.newContext({
   23 |             recordVideo: {
   24 |                 dir: testInfo.outputPath('videos'),
   25 |                 size: {
   26 |                     width: 1920,
   27 |                     height: 1080
   28 |                 }
   29 |             }
   30 |         });
   31 |         page = await context.newPage();
   32 |         pageManager = new PageManager(page);
   33 |         helper = new HelperBase(pageManager.getPage());
   34 |         await pageManager.onLoginPage().openLoginPage();
   35 |         await pageManager.onDashboardPage().closeReadUserGuidePopUp();
   36 |         await pageManager.onDashboardPage().openProject(projectTitle);
   37 |         await pageManager.onDashboardPage().verifyLoadingBehavior();
   38 |         await pageManager.navigateTo.measurementPage();
   39 |         await expect(pageManager.getPage()).toHaveURL(/.*measurement*/);
   40 |
   41 |         measurementPage = pageManager.onMeasurementPage;
   42 |     });
   43 |
   44 |     test.beforeEach(async () => {
   45 |         ({ xStart, yStart } = await setupLocationCoordinates());
   46 |     });
   47 |
   48 |     test.afterAll(async ({ }, testInfo) => {
   49 |         // await deleteAllGroups(measurementPage);
   50 |         const videoPath = testInfo.outputPath('my-video.webm');
   51 |         await Promise.all([
   52 |             page.video()?.saveAs(videoPath),
   53 |             page.close()
   54 |         ]);
   55 |         testInfo.attachments.push({
   56 |             name: 'video',
   57 |             path: videoPath,
   58 |             contentType: 'video/webm'
   59 |         });
   60 |         await context.close();
   61 |     });
   62 |
   63 |     async function deleteAllGroups(measurementPage: MeasurementPage) {
   64 |         await measurementPage.deleteAllGroups();
   65 |         await measurementPage.validateNewGroupForOpenSpaceIsCreated();
   66 |     }
   67 |
   68 |     async function setupMeasurementGroup(measurementPage: MeasurementPage) {
   69 |         await measurementPage.createGroup();
   70 |         const groupId = await measurementPage.getGroupId();
   71 |         return groupId;
   72 |     }
   73 |
   74 |     async function setupLocationCoordinates() {
   75 |         const mapPage = pageManager.onMapPage;
   76 |         const boundingBox = await mapPage.getMapBoundingBox();
   77 |         if (!boundingBox) throw new Error('Bounding box not found');
   78 |         const { xStart, yStart } = await mapPage.getStaringPosition(boundingBox, 3);
   79 |         await mapPage.clickOnZoomInButton(faker.number.int({ min: 200, max: 300 }));
   80 |         return { xStart, yStart };
   81 |     }
   82 |
   83 |     async function markLocationOnMap(measurementPage: MeasurementPage, xStart: number, yStart: number) {
   84 |         const value = { min: 1, max: 200 };
   85 |         const randomX = Math.floor(faker.number.int({ min: value.min, max: value.max }) / 5) * 5;
   86 |         const randomY = Math.floor(faker.number.int({ min: value.min, max: value.max }) / 5) * 5;
   87 |         await pageManager.onMapPage.moveMouseToCenter(xStart + randomX, yStart + randomY);
   88 |         await helper.waitForNumberOfSeconds(1);
   89 |         await pageManager.onMapPage.moveMouseToCenter(xStart + randomX, yStart + randomY);
   90 |
   91 |         const expectedYCoordinate = await measurementPage.getValueOfYCoordinate();
   92 |         const expectedXCoordinate = await measurementPage.getValueOfXCoordinate();
   93 |
   94 |         await measurementPage.createNewMeasurementItem(xStart + randomX, yStart + randomY);
   95 |         return { expectedYCoordinate, expectedXCoordinate };
   96 |     }
   97 |
   98 |     async function hoverAndGetValueFromMap(measurementPage: MeasurementPage, LocationTitle: string) {
   99 |         await measurementPage.hoverOverMeasurementItemInMap(LocationTitle);
  100 |         const { y: yCoordinateOnMap, x: xCoordinateOnMap } = await measurementPage.getYXValueFromMap();
  101 |         await helper.waitForNumberOfSeconds(1);
  102 |         const expectedElevation = await measurementPage.getElevationValueFromMap();
  103 |         return { yCoordinateOnMap, xCoordinateOnMap, expectedElevation };
  104 |     }
  105 |
  106 |     async function getLocationValueFromSideBar(measurementPage: MeasurementPage, locationId: string) {
  107 |         const yCoordinateOnSideBar = await measurementPage.getValueOfYFromSideBar(locationId);
  108 |         const xCoordinateOnSideBar = await measurementPage.getValueOfXFromSideBar(locationId);
  109 |         const elevationOnSideBar = await measurementPage.getElevationValueFromSideBar(locationId);
  110 |         return { yCoordinateOnSideBar, xCoordinateOnSideBar, elevationOnSideBar };
  111 |     }
  112 |
  113 |     async function assertLocationValuesOnMapAndSideBarWithExpectedValues(yCoordinateOnMap: string, xCoordinateOnMap: string, yCoordinateOnSideBar: string, xCoordinateOnSideBar: string, elevationOnSideBar: string, expectedYCoordinate: string, expectedXCoordinate: string, expectedElevation: string) {
  114 |         expect(yCoordinateOnMap, 'Y Coordinate on map is not equal to expected Y Coordinate').toBe(expectedYCoordinate);
  115 |         expect(xCoordinateOnMap, 'X Coordinate on map is not equal to expected X Coordinate').toBe(expectedXCoordinate);
  116 |         expect(yCoordinateOnSideBar, 'Y Coordinate on side bar is not equal to expected Y Coordinate').toBe(expectedYCoordinate);
  117 |         expect(xCoordinateOnSideBar, 'X Coordinate on side bar is not equal to expected X Coordinate').toBe(expectedXCoordinate);
> 118 |         expect(elevationOnSideBar, 'Elevation on side bar is not equal to expected Elevation').toBe(expectedElevation);
      |                                                                                                ^ Error: Elevation on side bar is not equal to expected Elevation
  119 |     }
  120 |
  121 |     async function assertLocationResponseValuesWithExpectedValues(location: any, expectedYCoordinate: string, expectedXCoordinate: string) {
  122 |         expect(location, 'Location coordinates are missing in response').toBeDefined();
  123 |         expect(Array.isArray(location), 'Location should be an array').toBe(true);
  124 |         expect(location.length).toBe(2);
  125 |
  126 |         const [xCoordFromResponse, yCoordFromResponse] = location;
  127 |
  128 |         expect(typeof yCoordFromResponse).toBe('number');
  129 |         expect(typeof xCoordFromResponse).toBe('number');
  130 |
  131 |         expect(yCoordFromResponse.toFixed(3), 'Y Coordinate from response is not equal to expected Y Coordinate').toBe(expectedYCoordinate);
  132 |         expect(xCoordFromResponse.toFixed(3), 'X Coordinate from response is not equal to expected X Coordinate').toBe(expectedXCoordinate);
  133 |     }
  134 |
  135 |     test.describe('Group Delete Test', () => {
  136 |
  137 |         test('should create a group and delete it using context menu delete in the measurement page', async ({ }) => {
  138 |             const groupId = await setupMeasurementGroup(measurementPage);
  139 |
  140 |             await measurementPage.toggleShowHideGroupFolder(groupId);
  141 |
  142 |             await measurementPage.deleteGroup(groupId);
  143 |             expect(await measurementPage.verifyGroupDeleted(groupId)).toBe(true);
  144 |             await measurementPage.validateGroupIsNotDisplayedInUI(groupId);
  145 |         });
  146 |
  147 |         test('should create a group, sub group under it and delete group using context menu delete in the measurement page', async ({ }) => {
  148 |             const groupId = await setupMeasurementGroup(measurementPage);
  149 |             console.log(`Created Group ID: ${groupId}`);
  150 |
  151 |             await measurementPage.createSubGroup();
  152 |             const subGroupId = await measurementPage.getGroupId();
  153 |             console.log(`Created Sub Group ID: ${subGroupId}`);
  154 |
  155 |             await measurementPage.toggleShowHideGroupFolder(groupId);
  156 |             await measurementPage.deleteGroup(groupId);
  157 |             expect(await measurementPage.verifyGroupDeleted(groupId)).toBe(true);
  158 |             await measurementPage.validateGroupIsNotDisplayedInUI(groupId);
  159 |
  160 |
  161 |         });
  162 |
  163 |         test('Should create a group and location and delete MeasurementItem and group using context menu delete in the measurement page', async ({ }) => {
  164 |
  165 |             const groupId = await setupMeasurementGroup(measurementPage);
  166 |             console.log(`Created Group ID: ${groupId}`);
  167 |
  168 |             const { xStart, yStart } = await setupLocationCoordinates();
  169 |
  170 |             await pageManager.onMapPage.clickOnLocationMarker();
  171 |             await measurementPage.createNewMeasurementItem(xStart, yStart);
  172 |             const responseData = await measurementPage.getMeasurementItemPostResponse();
  173 |             const locationId = responseData.data.id;
  174 |             console.log(`Created Group ID: ${locationId}`);
  175 |
  176 |             await measurementPage.validateMeasurementItemIsShownInMap(locationId);
  177 |             await measurementPage.toggleShowHideLayer(locationId);
  178 |             await measurementPage.validateMeasurementItemIsNotShownInMap(locationId);
  179 |             await measurementPage.toggleShowHideLayer(locationId);
  180 |             await measurementPage.validateMeasurementItemIsShownInMap(locationId);
  181 |
  182 |
  183 |             await measurementPage.renameMeasurementItem(locationId, newName);
  184 |
  185 |             await measurementPage.centerOnMap(locationId);
  186 |             await measurementPage.toggleShowHideDetails(locationId);
  187 |
  188 |             await measurementPage.deleteMeasurementItem(locationId);
  189 |             const isMeasurementItemDeleted = await measurementPage.verifyMeasurementItemDeleted(locationId);
  190 |             expect(isMeasurementItemDeleted).toBe(true);
  191 |             await measurementPage.validateMeasurementItemIsNotDisplayedInUI(locationId);
  192 |
  193 |             await measurementPage.deleteGroup(groupId);
  194 |             const isDeleted = await measurementPage.verifyGroupDeleted(groupId);
  195 |             expect(isDeleted).toBe(true);
  196 |             await measurementPage.validateGroupIsNotDisplayedInUI(groupId);
  197 |
  198 |
  199 |
  200 |         });
  201 |
  202 |         test('Should create a group , sub group and location under sub group and delete MeasurementItem and group using context menu delete in the measurement page', async ({ }) => {
  203 |
  204 |             const groupId = await setupMeasurementGroup(measurementPage);
  205 |             console.log(`Created Group ID: ${groupId}`);
  206 |
  207 |             await measurementPage.createSubGroup();
  208 |             const subGroupId = await measurementPage.getGroupId();
  209 |             console.log(`Created Sub Group ID: ${subGroupId}`);
  210 |
  211 |             const { xStart, yStart } = await setupLocationCoordinates();
  212 |
  213 |             await pageManager.onMapPage.clickOnLocationMarker();
  214 |             await measurementPage.createNewMeasurementItem(xStart, yStart);
  215 |             const responseData = await measurementPage.getMeasurementItemPostResponse();
  216 |             const locationId = responseData.data.id;
  217 |             console.log(`Created Group ID: ${locationId}`);
  218 |
```